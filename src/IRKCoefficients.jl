#
# IRKCoefficients.jl file:
#   PolInterp
#   GaussLegendreCoefficients!
#   EstimateCoeffs!

function PolInterp(
        X::AbstractVector{ctype},
        Y::AbstractMatrix{ctype},
        Z::AbstractVector{ctype}
    ) where {ctype}
    N = length(X)
    M = length(Z)
    K = size(Y, 1)
    if size(Y, 2) != N
        error("columns(Y) != length(X)")
    end
    pz = zeros(ctype, K, M)

    @inbounds begin
        for i in 1:N
            lag = 1.0
            for j in 1:N
                if (j != i)
                    lag *= X[i] - X[j]
                end
            end
            lag = 1 / lag
            for m in 1:M
                liz = lag
                for j in 1:N
                    if (j != i)
                        liz *= Z[m] - X[j]
                    end
                end
                for k in 1:K
                    pz[k, m] += Y[k, i] * liz
                end
            end
        end
    end
    return pz
end

function GaussLegendreCoefficients!(s, mu, c, b, eta, T::Type{<:CompiledFloats})
    if s == 8
        mu[1, 1] = convert(T, 0.5)

        mu[2, 1] = convert(T, +1.0818949631055814971365081647359309e+0)
        mu[2, 2] = convert(T, 0.5)

        mu[3, 1] = convert(T, +9.5995729622205494766003095439844678e-1)
        mu[3, 2] = convert(T, +1.086958924300832723329070964616248e+0)
        mu[3, 3] = convert(T, 0.5)

        mu[4, 1] = convert(T, +1.0247213458032003748680445816450829e+0)
        mu[4, 2] = convert(T, +9.5505887369737431186016905653386876e-1)
        mu[4, 3] = convert(T, +1.0880938387323083134422138713913203e+0)
        mu[4, 4] = convert(T, 0.5)

        mu[5, 1] = convert(T, +9.830238267636289069731182912388839e-1)
        mu[5, 2] = convert(T, +1.0287597754747493109782305570410685e+0)
        mu[5, 3] = convert(T, +9.5383453518519996588326911440754302e-1)
        mu[5, 4] = convert(T, +1.0883471611098277842507073806008045e+0)
        mu[5, 5] = convert(T, 0.5)

        mu[6, 1] = convert(T, +1.0122259141132982060539425317219435e+0)
        mu[6, 2] = convert(T, +9.7998287236359129082628958290257329e-1)
        mu[6, 3] = convert(T, +1.0296038730649779374630125982121223e+0)
        mu[6, 4] = convert(T, +9.5383453518519996588326911440754302e-1)
        mu[6, 5] = convert(T, +1.0880938387323083134422138713913203e+0)
        mu[6, 6] = convert(T, 0.5)

        mu[7, 1] = convert(T, +9.9125143323080263118822334698608777e-1)
        mu[7, 2] = convert(T, +1.0140743558891669291459735166525994e+0)
        mu[7, 3] = convert(T, +9.7998287236359129082628958290257329e-1)
        mu[7, 4] = convert(T, +1.0287597754747493109782305570410685e+0)
        mu[7, 5] = convert(T, +9.5505887369737431186016905653386876e-1)
        mu[7, 6] = convert(T, +1.086958924300832723329070964616248e+0)
        mu[7, 7] = convert(T, 0.5)

        mu[8, 1] = convert(T, +1.0054828082532158826793409353214951e+0)
        mu[8, 2] = convert(T, +9.9125143323080263118822334698608777e-1)
        mu[8, 3] = convert(T, +1.0122259141132982060539425317219435e+0)
        mu[8, 4] = convert(T, +9.830238267636289069731182912388839e-1)
        mu[8, 5] = convert(T, +1.0247213458032003748680445816450829e+0)
        mu[8, 6] = convert(T, +9.5995729622205494766003095439844678e-1)
        mu[8, 7] = convert(T, +1.0818949631055814971365081647359309e+0)
        mu[8, 8] = convert(T, 0.5)

        b .= convert.(
            T,
            [
                +5.0614268145188129576265677154981094e-2,
                +1.1119051722668723527217799721312045e-1,
                +1.5685332293894364366898110099330067e-1,
                +1.8134189168918099148257522463859781e-1,
                +1.8134189168918099148257522463859781e-1,
                +1.5685332293894364366898110099330067e-1,
                +1.1119051722668723527217799721312045e-1,
                +5.0614268145188129576265677154981094e-2,
            ]
        )

        c .= convert.(
            T,
            [
                +1.9855071751231884158219565715263505e-2,
                +1.016667612931866302042230317620848e-1,
                +2.3723379504183550709113047540537686e-1,
                +4.0828267875217509753026192881990801e-1,
                +5.9171732124782490246973807118009203e-1,
                +7.6276620495816449290886952459462321e-1,
                +8.9833323870681336979577696823791522e-1,
                +9.8014492824876811584178043428473653e-1,
            ]
        )

        eta[1, 1] = convert(T, 0.006007708087483310151200033288887425442226231098175)
        eta[2, 1] = convert(T, 0.079730759962116343197990886437764856964349746704102)
        eta[2, 2] = convert(T, 0.012834197951873016485535572428489103913307189941406)
        eta[3, 1] = convert(T, 0.21908071654795546745475576244643889367580413818359)
        eta[3, 2] = convert(T, 0.1321457164990910426727310778005630709230899810791)
        eta[3, 3] = convert(T, 0.018025789769441320081755364412856579292565584182739)
        eta[4, 1] = convert(T, 0.38684719802179423631116605974966660141944885253906)
        eta[4, 2] = convert(T, 0.3091811776250786292230543494952144101262092590332)
        eta[4, 3] = convert(T, 0.16674651878753837808133653197728563100099563598633)
        eta[4, 4] = convert(T, 0.020815992475314570864242114112130366265773773193359)
        eta[5, 1] = convert(T, 0.57333707905312691899268884299090132117271423339844)
        eta[5, 2] = convert(T, 0.48779937919119881195584298438916448503732681274414)
        eta[5, 3] = convert(T, 0.35748934714922175892581890366273000836372375488281)
        eta[5, 4] = convert(T, 0.1788245799340220654194411054049851372838020324707)
        eta[5, 5] = convert(T, 0.020815992475314570864242114112130366265773773193359)
        eta[6, 1] = convert(T, 0.74158747583362827349162671453086659312248229980469)
        eta[6, 2] = convert(T, 0.66307621239577219096617000104743055999279022216797)
        eta[6, 3] = convert(T, 0.52306441490158261942156059376429766416549682617188)
        eta[6, 4] = convert(T, 0.35748934714922175892581890366273000836372375488281)
        eta[6, 5] = convert(T, 0.16674651878753837808133653197728563100099563598633)
        eta[6, 6] = convert(T, 0.018025789769441320081755364412856579292565584182739)
        eta[7, 1] = convert(T, 0.87957363693317058839227229327661916613578796386719)
        eta[7, 2] = convert(T, 0.79504484698984212442951502453070133924484252929688)
        eta[7, 3] = convert(T, 0.66307621239577219096617000104743055999279022216797)
        eta[7, 4] = convert(T, 0.48779937919119881195584298438916448503732681274414)
        eta[7, 5] = convert(T, 0.3091811776250786292230543494952144101262092590332)
        eta[7, 6] = convert(T, 0.1321457164990910426727310778005630709230899810791)
        eta[7, 7] = convert(T, 0.012834197951873016485535572428489103913307189941406)
        eta[8, 1] = convert(T, 0.95954723356073712281499865639489144086837768554688)
        eta[8, 2] = convert(T, 0.87957363693317058839227229327661916613578796386719)
        eta[8, 3] = convert(T, 0.74158747583362827349162671453086659312248229980469)
        eta[8, 4] = convert(T, 0.57333707905312691899268884299090132117271423339844)
        eta[8, 5] = convert(T, 0.38684719802179423631116605974966660141944885253906)
        eta[8, 6] = convert(T, 0.21908071654795546745475576244643889367580413818359)
        eta[8, 7] = convert(T, 0.079730759962116343197990886437764856964349746704102)
        eta[8, 8] = convert(T, 0.006007708087483310151200033288887425442226231098175)

    elseif s == 6
        mu[1, 1] = convert(T, 0.5)

        mu[2, 1] = convert(T, +1.0818475530664536649892255722466846e+0)
        mu[2, 2] = convert(T, 0.5)

        mu[3, 1] = convert(T, +9.6014202605445556674282376780842681e-1)
        mu[3, 2] = convert(T, +1.0867685306776686226888768418232946e+0)
        mu[3, 3] = convert(T, 0.5)

        mu[4, 1] = convert(T, +1.0242303450725844853844555950608193e+0)
        mu[4, 2] = convert(T, +9.5570486162285259436203901940475413e-1)
        mu[4, 3] = convert(T, +1.0875482700226107923584465454968425e+0)
        mu[4, 4] = convert(T, 0.5)

        mu[5, 1] = convert(T, +9.8417551353387379337690275383201113e-1)
        mu[5, 2] = convert(T, +1.0270937555058589548364643792156666e+0)
        mu[5, 3] = convert(T, +9.5570486162285259436203901940475413e-1)
        mu[5, 4] = convert(T, +1.0867685306776686226888768418232946e+0)
        mu[5, 5] = convert(T, 0.5)

        mu[6, 1] = convert(T, +1.0094881958787998724632074658957684e+0)
        mu[6, 2] = convert(T, +9.8417551353387379337690275383201113e-1)
        mu[6, 3] = convert(T, +1.0242303450725844853844555950608193e+0)
        mu[6, 4] = convert(T, +9.6014202605445556674282376780842681e-1)
        mu[6, 5] = convert(T, +1.0818475530664536649892255722466846e+0)
        mu[6, 6] = convert(T, 0.5)

        b .= convert.(
            T,
            [
                +8.5662246189585172520148071086366447e-2,
                +1.8038078652406930378491675691885806e-1,
                +2.339569672863455236949351719947755e-1,
                +2.339569672863455236949351719947755e-1,
                +1.8038078652406930378491675691885806e-1,
                +8.5662246189585172520148071086366447e-2,
            ]
        )

        c .= convert.(
            T,
            [
                +3.3765242898423986093849222753002695e-2,
                +1.6939530676686774316930020249004733e-1,
                +3.8069040695840154568474913915964403e-1,
                +6.1930959304159845431525086084035597e-1,
                +8.3060469323313225683069979750995267e-1,
                +9.662347571015760139061507772469973e-1,
            ]
        )

        eta[1, 1] = convert(T, 0.010579388730372727908668473162379086716100573539734)
        eta[2, 1] = convert(T, 0.13159084699748233027172261699888622388243675231934)
        eta[2, 2] = convert(T, 0.021667209241614849429824474214001384098082780838013)
        eta[3, 1] = convert(T, 0.35030624293010809156001528208435047417879104614258)
        eta[3, 2] = convert(T, 0.20500126411486685462648438260657712817192077636719)
        eta[3, 3] = convert(T, 0.027992472260423274105223256924546149093657732009888)
        eta[4, 1] = convert(T, 0.58252347878215904319887386009213514626026153564453)
        eta[4, 2] = convert(T, 0.45461287216601309335572977943229489028453826904297)
        eta[4, 3] = convert(T, 0.23151741075856097085150508974038530141115188598633)
        eta[4, 4] = convert(T, 0.027992472260423274105223256924546149093657732009888)
        eta[5, 1] = convert(T, 0.79937008095805162088964834765647538006305694580078)
        eta[5, 2] = convert(T, 0.65745682267974558943279816958238370716571807861328)
        eta[5, 3] = convert(T, 0.45461287216601309335572977943229489028453826904297)
        eta[5, 4] = convert(T, 0.20500126411486685462648438260657712817192077636719)
        eta[5, 5] = convert(T, 0.021667209241614849429824474214001384098082780838013)
        eta[6, 1] = convert(T, 0.93073757887454822146366950619267299771308898925781)
        eta[6, 2] = convert(T, 0.79937008095805162088964834765647538006305694580078)
        eta[6, 3] = convert(T, 0.58252347878215904319887386009213514626026153564453)
        eta[6, 4] = convert(T, 0.35030624293010809156001528208435047417879104614258)
        eta[6, 5] = convert(T, 0.13159084699748233027172261699888622388243675231934)
        eta[6, 6] = convert(T, 0.010579388730372727908668473162379086716100573539734)

        bc = zero(s)

    elseif s == 4
        mu[1, 1] = convert(T, 0.5)

        mu[2, 1] = convert(T, +1.0815897500322798725550774019062491e+0)
        mu[2, 2] = convert(T, 0.5)

        mu[3, 1] = convert(T, +9.612740734321142399390889006793563e-1)
        mu[3, 2] = convert(T, +1.0855037514105193511704394326198952e+0)
        mu[3, 3] = convert(T, 0.5)

        mu[4, 1] = convert(T, +1.0204404206840406424250678899956346e+0)
        mu[4, 2] = convert(T, +9.612740734321142399390889006793563e-1)
        mu[4, 3] = convert(T, +1.0815897500322798725550774019062491e+0)
        mu[4, 4] = convert(T, 0.5)

        b .= convert.(
            T,
            [
                +1.739274225687269286865319746109997e-1,
                +3.260725774312730713134680253890003e-1,
                +3.260725774312730713134680253890003e-1,
                +1.739274225687269286865319746109997e-1,
            ]
        )

        c .= convert.(
            T,
            [
                +6.9431844202973712388026755553595247e-2,
                +3.3000947820757186759866712044837766e-1,
                +6.6999052179242813240133287955162234e-1,
                +9.3056815579702628761197324444640475e-1,
            ]
        )

        eta[1, 1] = convert(T, 0.023217681209822167015532912159869738388806581497192)
        eta[2, 1] = convert(T, 0.25046988139654768890096647737664170563220977783203)
        eta[2, 2] = convert(T, 0.042379986428661794994887657139770453795790672302246)
        eta[3, 1] = convert(T, 0.60866970297190714500601416148128919303417205810547)
        eta[3, 2] = convert(T, 0.32667071179116297097166921048483345657587051391602)
        eta[3, 3] = convert(T, 0.042379986428661794994887657139770453795790672302246)
        eta[4, 1] = convert(T, 0.85552061885951591335697230533696711063385009765625)
        eta[4, 2] = convert(T, 0.60866970297190714500601416148128919303417205810547)
        eta[4, 3] = convert(T, 0.25046988139654768890096647737664170563220977783203)
        eta[4, 4] = convert(T, 0.023217681209822167015532912159869738388806581497192)

    elseif s == 2
        mu[1, 1] = convert(T, 0.5)

        mu[2, 1] = convert(T, +1.0773502691896257645091487805019575e+0)
        mu[2, 2] = convert(T, 0.5)

        b .= convert.(
            T,
            [
                +0.5,
                +0.5,
            ]
        )

        c .= convert.(
            T,
            [
                +2.1132486540518711774542560974902127e-1,
                +7.8867513459481288225457439025097873e-1,
            ]
        )

        eta[1, 1] = convert(T, 0.083333333333333328707404064061847748234868049621582)
        eta[2, 1] = convert(T, 0.53867513459481286552943402057280763983726501464844)
        eta[2, 2] = convert(T, 0.083333333333333328707404064061847748234868049621582)

    else
        error("s=", s, " value is wrong!")
    end

    @inbounds begin
        for i in 1:s
            for j in (i + 1):s
                mu[i, j] = 1 - mu[j, i]
                eta[i, j] = eta[j, i] + c[i] - c[j]
            end
        end
    end

    return nothing
end

function GaussLegendreCoefficients!(s, mu, c, b, eta, T)
    if s == 8
        mu[1, 1] = parse(T, "0.5")

        mu[2, 1] = parse(T, "+1.0818949631055814971365081647359309e+00")
        mu[2, 2] = parse(T, "0.5")

        mu[3, 1] = parse(T, "+9.5995729622205494766003095439844678e-01")
        mu[3, 2] = parse(T, "+1.0869589243008327233290709646162480e+00")
        mu[3, 3] = parse(T, "0.5")

        mu[4, 1] = parse(T, "+1.0247213458032003748680445816450829e+00")
        mu[4, 2] = parse(T, "+9.5505887369737431186016905653386876e-01")
        mu[4, 3] = parse(T, "+1.0880938387323083134422138713913203e+00")
        mu[4, 4] = parse(T, "0.5")

        mu[5, 1] = parse(T, "+9.8302382676362890697311829123888390e-01")
        mu[5, 2] = parse(T, "+1.0287597754747493109782305570410685e+00")
        mu[5, 3] = parse(T, "+9.5383453518519996588326911440754302e-01")
        mu[5, 4] = parse(T, "+1.0883471611098277842507073806008045e+00")
        mu[5, 5] = parse(T, "0.5")

        mu[6, 1] = parse(T, "+1.0122259141132982060539425317219435e+00")
        mu[6, 2] = parse(T, "+9.7998287236359129082628958290257329e-01")
        mu[6, 3] = parse(T, "+1.0296038730649779374630125982121223e+00")
        mu[6, 4] = parse(T, "+9.5383453518519996588326911440754302e-01")
        mu[6, 5] = parse(T, "+1.0880938387323083134422138713913203e+00")
        mu[6, 6] = parse(T, "0.5")

        mu[7, 1] = parse(T, "+9.9125143323080263118822334698608777e-01")
        mu[7, 2] = parse(T, "+1.0140743558891669291459735166525994e+00")
        mu[7, 3] = parse(T, "+9.7998287236359129082628958290257329e-01")
        mu[7, 4] = parse(T, "+1.0287597754747493109782305570410685e+00")
        mu[7, 5] = parse(T, "+9.5505887369737431186016905653386876e-01")
        mu[7, 6] = parse(T, "+1.0869589243008327233290709646162480e+00")
        mu[7, 7] = parse(T, "0.5")

        mu[8, 1] = parse(T, "+1.0054828082532158826793409353214951e+00")
        mu[8, 2] = parse(T, "+9.9125143323080263118822334698608777e-01")
        mu[8, 3] = parse(T, "+1.0122259141132982060539425317219435e+00")
        mu[8, 4] = parse(T, "+9.8302382676362890697311829123888390e-01")
        mu[8, 5] = parse(T, "+1.0247213458032003748680445816450829e+00")
        mu[8, 6] = parse(T, "+9.5995729622205494766003095439844678e-01")
        mu[8, 7] = parse(T, "+1.0818949631055814971365081647359309e+00")
        mu[8, 8] = parse(T, "0.5")

        b .= [
            parse(T, "+5.0614268145188129576265677154981094e-02"),
            parse(T, "+1.1119051722668723527217799721312045e-01"),
            parse(T, "+1.5685332293894364366898110099330067e-01"),
            parse(T, "+1.8134189168918099148257522463859781e-01"),
            parse(T, "+1.8134189168918099148257522463859781e-01"),
            parse(T, "+1.5685332293894364366898110099330067e-01"),
            parse(T, "+1.1119051722668723527217799721312045e-01"),
            parse(T, "+5.0614268145188129576265677154981094e-02"),
        ]

        c .= [
            parse(T, "+1.9855071751231884158219565715263505e-02"),
            parse(T, "+1.0166676129318663020422303176208480e-01"),
            parse(T, "+2.3723379504183550709113047540537686e-01"),
            parse(T, "+4.0828267875217509753026192881990801e-01"),
            parse(T, "+5.9171732124782490246973807118009203e-01"),
            parse(T, "+7.6276620495816449290886952459462321e-01"),
            parse(T, "+8.9833323870681336979577696823791522e-01"),
            parse(T, "+9.8014492824876811584178043428473653e-01"),
        ]

        eta[1, 1] = parse(T, "0.0060077080874833101512000332888874254422262310981750")
        eta[2, 1] = parse(T, "0.079730759962116343197990886437764856964349746704102")
        eta[2, 2] = parse(T, "0.012834197951873016485535572428489103913307189941406")
        eta[3, 1] = parse(T, "0.21908071654795546745475576244643889367580413818359")
        eta[3, 2] = parse(T, "0.13214571649909104267273107780056307092308998107910")
        eta[3, 3] = parse(T, "0.018025789769441320081755364412856579292565584182739")
        eta[4, 1] = parse(T, "0.38684719802179423631116605974966660141944885253906")
        eta[4, 2] = parse(T, "0.30918117762507862922305434949521441012620925903320")
        eta[4, 3] = parse(T, "0.16674651878753837808133653197728563100099563598633")
        eta[4, 4] = parse(T, "0.020815992475314570864242114112130366265773773193359")
        eta[5, 1] = parse(T, "0.57333707905312691899268884299090132117271423339844")
        eta[5, 2] = parse(T, "0.48779937919119881195584298438916448503732681274414")
        eta[5, 3] = parse(T, "0.35748934714922175892581890366273000836372375488281")
        eta[5, 4] = parse(T, "0.17882457993402206541944110540498513728380203247070")
        eta[5, 5] = parse(T, "0.020815992475314570864242114112130366265773773193359")
        eta[6, 1] = parse(T, "0.74158747583362827349162671453086659312248229980469")
        eta[6, 2] = parse(T, "0.66307621239577219096617000104743055999279022216797")
        eta[6, 3] = parse(T, "0.52306441490158261942156059376429766416549682617188")
        eta[6, 4] = parse(T, "0.35748934714922175892581890366273000836372375488281")
        eta[6, 5] = parse(T, "0.16674651878753837808133653197728563100099563598633")
        eta[6, 6] = parse(T, "0.018025789769441320081755364412856579292565584182739")
        eta[7, 1] = parse(T, "0.87957363693317058839227229327661916613578796386719")
        eta[7, 2] = parse(T, "0.79504484698984212442951502453070133924484252929688")
        eta[7, 3] = parse(T, "0.66307621239577219096617000104743055999279022216797")
        eta[7, 4] = parse(T, "0.48779937919119881195584298438916448503732681274414")
        eta[7, 5] = parse(T, "0.30918117762507862922305434949521441012620925903320")
        eta[7, 6] = parse(T, "0.13214571649909104267273107780056307092308998107910")
        eta[7, 7] = parse(T, "0.012834197951873016485535572428489103913307189941406")
        eta[8, 1] = parse(T, "0.95954723356073712281499865639489144086837768554688")
        eta[8, 2] = parse(T, "0.87957363693317058839227229327661916613578796386719")
        eta[8, 3] = parse(T, "0.74158747583362827349162671453086659312248229980469")
        eta[8, 4] = parse(T, "0.57333707905312691899268884299090132117271423339844")
        eta[8, 5] = parse(T, "0.38684719802179423631116605974966660141944885253906")
        eta[8, 6] = parse(T, "0.21908071654795546745475576244643889367580413818359")
        eta[8, 7] = parse(T, "0.079730759962116343197990886437764856964349746704102")
        eta[8, 8] = parse(T, "0.0060077080874833101512000332888874254422262310981750")

    elseif s == 6
        mu[1, 1] = parse(T, "0.5")

        mu[2, 1] = parse(T, "+1.0818475530664536649892255722466846e+00")
        mu[2, 2] = parse(T, "0.5")

        mu[3, 1] = parse(T, "+9.6014202605445556674282376780842681e-01")
        mu[3, 2] = parse(T, "+1.0867685306776686226888768418232946e+00")
        mu[3, 3] = parse(T, "0.5")

        mu[4, 1] = parse(T, "+1.0242303450725844853844555950608193e+00")
        mu[4, 2] = parse(T, "+9.5570486162285259436203901940475413e-01")
        mu[4, 3] = parse(T, "+1.0875482700226107923584465454968425e+00")
        mu[4, 4] = parse(T, "0.5")

        mu[5, 1] = parse(T, "+9.8417551353387379337690275383201113e-01")
        mu[5, 2] = parse(T, "+1.0270937555058589548364643792156666e+00")
        mu[5, 3] = parse(T, "+9.5570486162285259436203901940475413e-01")
        mu[5, 4] = parse(T, "+1.0867685306776686226888768418232946e+00")
        mu[5, 5] = parse(T, "0.5")

        mu[6, 1] = parse(T, "+1.0094881958787998724632074658957684e+00")
        mu[6, 2] = parse(T, "+9.8417551353387379337690275383201113e-01")
        mu[6, 3] = parse(T, "+1.0242303450725844853844555950608193e+00")
        mu[6, 4] = parse(T, "+9.6014202605445556674282376780842681e-01")
        mu[6, 5] = parse(T, "+1.0818475530664536649892255722466846e+00")
        mu[6, 6] = parse(T, "0.5")

        b .= [
            parse(T, "+8.5662246189585172520148071086366447e-02"),
            parse(T, "+1.8038078652406930378491675691885806e-01"),
            parse(T, "+2.3395696728634552369493517199477550e-01"),
            parse(T, "+2.3395696728634552369493517199477550e-01"),
            parse(T, "+1.8038078652406930378491675691885806e-01"),
            parse(T, "+8.5662246189585172520148071086366447e-02"),
        ]

        c .= [
            parse(T, "+3.3765242898423986093849222753002695e-02"),
            parse(T, "+1.6939530676686774316930020249004733e-01"),
            parse(T, "+3.8069040695840154568474913915964403e-01"),
            parse(T, "+6.1930959304159845431525086084035597e-01"),
            parse(T, "+8.3060469323313225683069979750995267e-01"),
            parse(T, "+9.6623475710157601390615077724699730e-01"),
        ]

        eta[1, 1] = parse(T, "0.010579388730372727908668473162379086716100573539734")
        eta[2, 1] = parse(T, "0.13159084699748233027172261699888622388243675231934")
        eta[2, 2] = parse(T, "0.021667209241614849429824474214001384098082780838013")
        eta[3, 1] = parse(T, "0.35030624293010809156001528208435047417879104614258")
        eta[3, 2] = parse(T, "0.20500126411486685462648438260657712817192077636719")
        eta[3, 3] = parse(T, "0.027992472260423274105223256924546149093657732009888")
        eta[4, 1] = parse(T, "0.58252347878215904319887386009213514626026153564453")
        eta[4, 2] = parse(T, "0.45461287216601309335572977943229489028453826904297")
        eta[4, 3] = parse(T, "0.23151741075856097085150508974038530141115188598633")
        eta[4, 4] = parse(T, "0.027992472260423274105223256924546149093657732009888")
        eta[5, 1] = parse(T, "0.79937008095805162088964834765647538006305694580078")
        eta[5, 2] = parse(T, "0.65745682267974558943279816958238370716571807861328")
        eta[5, 3] = parse(T, "0.45461287216601309335572977943229489028453826904297")
        eta[5, 4] = parse(T, "0.20500126411486685462648438260657712817192077636719")
        eta[5, 5] = parse(T, "0.021667209241614849429824474214001384098082780838013")
        eta[6, 1] = parse(T, "0.93073757887454822146366950619267299771308898925781")
        eta[6, 2] = parse(T, "0.79937008095805162088964834765647538006305694580078")
        eta[6, 3] = parse(T, "0.58252347878215904319887386009213514626026153564453")
        eta[6, 4] = parse(T, "0.35030624293010809156001528208435047417879104614258")
        eta[6, 5] = parse(T, "0.13159084699748233027172261699888622388243675231934")
        eta[6, 6] = parse(T, "0.010579388730372727908668473162379086716100573539734")

    elseif s == 4
        mu[1, 1] = parse(T, "0.5")
        mu[2, 1] = parse(T, "+1.0815897500322798725550774019062491e+00")
        mu[2, 2] = parse(T, "0.5")
        mu[3, 1] = parse(T, "+9.6127407343211423993908890067935630e-01")
        mu[3, 2] = parse(T, "+1.0855037514105193511704394326198952e+00")
        mu[3, 3] = parse(T, "0.5")
        mu[4, 1] = parse(T, "+1.0204404206840406424250678899956346e+00")
        mu[4, 2] = parse(T, "+9.6127407343211423993908890067935630e-01")
        mu[4, 3] = parse(T, "+1.0815897500322798725550774019062491e+00")
        mu[4, 4] = parse(T, "0.5")

        b .= [
            parse(T, "+1.7392742256872692868653197461099970e-01"),
            parse(T, "+3.2607257743127307131346802538900030e-01"),
            parse(T, "+3.2607257743127307131346802538900030e-01"),
            parse(T, "1.7392742256872692868653197461099970e-01"),
        ]

        c .= [
            parse(T, "+6.9431844202973712388026755553595247e-02"),
            parse(T, "3.3000947820757186759866712044837766e-01"),
            parse(T, "+6.6999052179242813240133287955162234e-01"),
            parse(T, "+9.3056815579702628761197324444640475e-01"),
        ]

        eta[1, 1] = parse(T, "0.023217681209822167015532912159869738388806581497192")
        eta[2, 1] = parse(T, "0.25046988139654768890096647737664170563220977783203")
        eta[2, 2] = parse(T, "0.042379986428661794994887657139770453795790672302246")
        eta[3, 1] = parse(T, "0.60866970297190714500601416148128919303417205810547")
        eta[3, 2] = parse(T, "0.32667071179116297097166921048483345657587051391602")
        eta[3, 3] = parse(T, "0.042379986428661794994887657139770453795790672302246")
        eta[4, 1] = parse(T, "0.85552061885951591335697230533696711063385009765625")
        eta[4, 2] = parse(T, "0.60866970297190714500601416148128919303417205810547")
        eta[4, 3] = parse(T, "0.25046988139654768890096647737664170563220977783203")
        eta[4, 4] = parse(T, "0.023217681209822167015532912159869738388806581497192")

    elseif s == 2
        mu[1, 1] = parse(T, "0.5")

        mu[2, 1] = parse(T, "+1.0773502691896257645091487805019575e+00")
        mu[2, 2] = parse(T, "0.5")

        b .= [
            parse(T, "0.5"),
            parse(T, "0.5"),
        ]

        c .= [
            parse(T, "+2.1132486540518711774542560974902127e-01"),
            parse(T, "+7.8867513459481288225457439025097873e-01"),
        ]

        eta[1, 1] = parse(T, "0.083333333333333328707404064061847748234868049621582")
        eta[2, 1] = parse(T, "0.53867513459481286552943402057280763983726501464844")
        eta[2, 2] = parse(T, "0.083333333333333328707404064061847748234868049621582")

    else
        error("s=", s, " value is wrong!")
    end

    @inbounds begin
        for i in 1:s
            for j in (i + 1):s
                mu[i, j] = 1 - mu[j, i]
                eta[i, j] = eta[j, i] + c[i] - c[j]
            end
        end
    end

    return nothing
end

function EstimateCoeffs!(s, alpha, T::Type{<:CompiledFloats})
    if s == 8
        c = convert.(
            T,
            [
                +1.9855071751231884158219565715263505e-2,
                +1.016667612931866302042230317620848e-1,
                +2.3723379504183550709113047540537686e-1,
                +4.0828267875217509753026192881990801e-1,
                +5.9171732124782490246973807118009203e-1,
                +7.6276620495816449290886952459462321e-1,
                +8.9833323870681336979577696823791522e-1,
                +9.8014492824876811584178043428473653e-1,
            ]
        )

    elseif s == 6
        c = convert.(
            T,
            [
                +3.3765242898423986093849222753002695e-2,
                +1.6939530676686774316930020249004733e-1,
                +3.8069040695840154568474913915964403e-1,
                +6.1930959304159845431525086084035597e-1,
                +8.3060469323313225683069979750995267e-1,
                +9.662347571015760139061507772469973e-1,
            ]
        )

    elseif s == 4
        c = convert.(
            T,
            [
                +6.9431844202973712388026755553595247e-2,
                +3.3000947820757186759866712044837766e-1,
                +6.6999052179242813240133287955162234e-1,
                +9.3056815579702628761197324444640475e-1,
            ]
        )

    elseif s == 2
        c = convert.(
            T,
            [
                +2.1132486540518711774542560974902127e-1,
                +7.8867513459481288225457439025097873e-1,
            ]
        )

    else
        error("s=", s, " value is wrong!")
    end

    B = vcat(zeros(T, s - 1), 1)
    M = [(c[i] - 1 / 2)^(k - 1) for i in 1:s, k in 1:s]'
    alpha .= 1000 * M \ B

    return
end

function EstimateCoeffs!(s, alpha, T)

    #    println("Estimate2: NO Compiled")

    if s == 8
        c = [
            parse(T, "+1.9855071751231884158219565715263505e-02"),
            parse(T, "+1.0166676129318663020422303176208480e-01"),
            parse(T, "+2.3723379504183550709113047540537686e-01"),
            parse(T, "+4.0828267875217509753026192881990801e-01"),
            parse(T, "+5.9171732124782490246973807118009203e-01"),
            parse(T, "+7.6276620495816449290886952459462321e-01"),
            parse(T, "+8.9833323870681336979577696823791522e-01"),
            parse(T, "+9.8014492824876811584178043428473653e-01"),
        ]

    elseif s == 6
        c = [
            parse(T, "+3.3765242898423986093849222753002695e-02"),
            parse(T, "+1.6939530676686774316930020249004733e-01"),
            parse(T, "+3.8069040695840154568474913915964403e-01"),
            parse(T, "+6.1930959304159845431525086084035597e-01"),
            parse(T, "+8.3060469323313225683069979750995267e-01"),
            parse(T, "+9.6623475710157601390615077724699730e-01"),
        ]

    elseif s == 4
        c = [
            parse(T, "+6.9431844202973712388026755553595247e-02"),
            parse(T, "3.3000947820757186759866712044837766e-01"),
            parse(T, "+6.6999052179242813240133287955162234e-01"),
            parse(T, "+9.3056815579702628761197324444640475e-01"),
        ]

    elseif s == 2
        c = [
            parse(T, "+2.1132486540518711774542560974902127e-01"),
            parse(T, "+7.8867513459481288225457439025097873e-01"),
        ]

    else
        error("s=", s, " value is wrong!")
    end

    B = vcat(zeros(T, s - 1), 1)
    M = [(c[i] - 1 / 2)^(k - 1) for i in 1:s, k in 1:s]'
    alpha .= 1000 * M \ B

    return
end
